<section class="py-16 bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Gallery Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Project 1 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="hardwood">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-hardwood-1.jpg' | asset_url }}" alt="Hardwood Flooring Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Elegant Oak Hardwood</h3>
            <p class="text-blue-100 text-sm">Minneapolis, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-amber-400 text-blue-900">
            Hardwood
          </span>
        </div>
      </div>

      <!-- Project 2 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="luxury-vinyl">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-lvp-1.jpg' | asset_url }}" alt="Luxury Vinyl Plank Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Modern Gray LVP</h3>
            <p class="text-blue-100 text-sm">St. Paul, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-900">
            Luxury Vinyl
          </span>
        </div>
      </div>

      <!-- Project 3 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="tile">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-tile-1.jpg' | asset_url }}" alt="Tile Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Subway Tile Backsplash</h3>
            <p class="text-blue-100 text-sm">Edina, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-400 text-white">
            Tile & Stone
          </span>
        </div>
      </div>

      <!-- Project 4 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="laminate">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-laminate-1.jpg' | asset_url }}" alt="Laminate Flooring Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Rustic Oak Laminate</h3>
            <p class="text-blue-100 text-sm">Bloomington, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-amber-600 text-white">
            Laminate
          </span>
        </div>
      </div>

      <!-- Project 5 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="hardwood">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-hardwood-2.jpg' | asset_url }}" alt="Hardwood Flooring Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Classic Maple Hardwood</h3>
            <p class="text-blue-100 text-sm">Plymouth, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-amber-400 text-blue-900">
            Hardwood
          </span>
        </div>
      </div>

      <!-- Project 6 -->
      <div class="gallery-item group relative overflow-hidden rounded-xl shadow-lg" data-category="luxury-vinyl">
        <div class="aspect-w-4 aspect-h-3">
          <img src="{{ 'project-lvp-2.jpg' | asset_url }}" alt="Luxury Vinyl Plank Project" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
          <div>
            <h3 class="text-white text-xl font-bold mb-1">Waterproof LVP Kitchen</h3>
            <p class="text-blue-100 text-sm">Eden Prairie, MN</p>
          </div>
        </div>
        <div class="absolute top-4 right-4">
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-900">
            Luxury Vinyl
          </span>
        </div>
      </div>
    </div>

    <!-- Load More Button -->
    <div class="mt-12 text-center">
      <button id="load-more" class="px-8 py-3 border border-blue-900 text-blue-900 rounded-full font-medium hover:bg-blue-900 hover:text-white transition-colors">
        Load More Projects
      </button>
    </div>
  </div>
</section>

<!-- Lightbox Modal -->
<div id="gallery-lightbox" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden items-center justify-center p-4">
  <button id="close-lightbox" class="absolute top-4 right-4 text-white text-3xl">&times;</button>
  <div class="relative max-w-4xl w-full">
    <img id="lightbox-image" src="" alt="" class="w-full max-h-[80vh] object-contain">
    <div id="lightbox-caption" class="text-white text-center mt-4"></div>
    <button id="prev-btn" class="absolute left-0 top-1/2 -translate-y-1/2 -translate-x-12 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
    </button>
    <button id="next-btn" class="absolute right-0 top-1/2 -translate-y-1/2 translate-x-12 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
    </button>
  </div>
</div>

{% schema %}
{
  "name": "Gallery Grid",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Our Recent Projects"
    },
    {
      "type": "text",
      "id": "load_more_text",
      "label": "Load More Button Text",
      "default": "Load More Projects"
    }
  ],
  "blocks": [
    {
      "type": "project",
      "name": "Project",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Project Title"
        },
        {
          "type": "text",
          "id": "location",
          "label": "Location"
        },
        {
          "type": "select",
          "id": "category",
          "label": "Category",
          "options": [
            {
              "value": "hardwood",
              "label": "Hardwood"
            },
            {
              "value": "luxury-vinyl",
              "label": "Luxury Vinyl"
            },
            {
              "value": "laminate",
              "label": "Laminate"
            },
            {
              "value": "tile",
              "label": "Tile & Stone"
            }
          ],
          "default": "hardwood"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gallery Grid",
      "category": "Gallery"
    }
  ]
}
{% endschema %}

{% javascript %}
document.addEventListener('DOMContentLoaded', function() {
  // Category filter functionality
  const filterButtons = document.querySelectorAll('[data-filter]');
  const galleryItems = document.querySelectorAll('.gallery-item');
  
  filterButtons.forEach(button => {
    button.addEventListener('click', () => {
      // Update active button
      filterButtons.forEach(btn => btn.classList.remove('active-filter'));
      button.classList.add('active-filter');
      
      // Filter items
      const filter = button.getAttribute('data-filter');
      
      galleryItems.forEach(item => {
        if (filter === 'all' || item.getAttribute('data-category') === filter) {
          item.style.display = 'block';
        } else {
          item.style.display = 'none';
        }
      });
    });
  });
  
  // Lightbox functionality
  const lightbox = document.getElementById('gallery-lightbox');
  const lightboxImg = document.getElementById('lightbox-image');
  const lightboxCaption = document.getElementById('lightbox-caption');
  const closeBtn = document.getElementById('close-lightbox');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  
  let currentIndex = 0;
  const items = Array.from(galleryItems);
  
  function openLightbox(index) {
    const item = items[index];
    const img = item.querySelector('img');
    const title = item.querySelector('h3')?.textContent || '';
    const location = item.querySelector('p')?.textContent || '';
    
    lightboxImg.src = img.src;
    lightboxImg.alt = img.alt;
    lightboxCaption.textContent = `${title} - ${location}`;
    currentIndex = index;
    lightbox.classList.remove('hidden');
    lightbox.classList.add('flex');
    document.body.style.overflow = 'hidden';
  }
  
  function closeLightbox() {
    lightbox.classList.add('hidden');
    lightbox.classList.remove('flex');
    document.body.style.overflow = '';
  }
  
  function showNext() {
    currentIndex = (currentIndex + 1) % items.length;
    openLightbox(currentIndex);
  }
  
  function showPrev() {
    currentIndex = (currentIndex - 1 + items.length) % items.length;
    openLightbox(currentIndex);
  }
  
  // Add click event to gallery items
  galleryItems.forEach((item, index) => {
    item.addEventListener('click', () => openLightbox(index));
  });
  
  // Add event listeners for lightbox controls
  closeBtn.addEventListener('click', closeLightbox);
  prevBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    showPrev();
  });
  nextBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    showNext();
  });
  
  // Close lightbox when clicking outside the image
  lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) {
      closeLightbox();
    }
  });
  
  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (lightbox.classList.contains('hidden')) return;
    
    switch(e.key) {
      case 'Escape':
        closeLightbox();
        break;
      case 'ArrowLeft':
        showPrev();
        break;
      case 'ArrowRight':
        showNext();
        break;
    }
  });
  
  // Load more functionality
  const loadMoreBtn = document.getElementById('load-more');
  if (loadMoreBtn) {
    loadMoreBtn.addEventListener('click', () => {
      // This would typically load more items via AJAX in a real implementation
      // For now, we'll just show an alert
      alert('In a real implementation, this would load more projects.');
    });
  }
});
{% endjavascript %}

<style>
  .gallery-item {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .gallery-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
  
  .aspect-w-4 {
    position: relative;
    padding-bottom: 75%; /* 4:3 Aspect Ratio */
  }
  
  .aspect-w-4 > * {
    position: absolute;
    height: 100%;
    width: 100%;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
  
  /* Lightbox animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  #gallery-lightbox {
    animation: fadeIn 0.3s ease-out;
  }
  
  /* Responsive adjustments */
  @media (max-width: 640px) {
    .grid {
      grid-template-columns: 1fr;
    }
  }
</style>
